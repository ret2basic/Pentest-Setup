#--------OSCP--------#

# PWK openvpn connection
alias pwk="openvpn --config /root/PWK/pwk2.ovpn --pull-filter ignore redirect-gateway"

# Get a copy of php-reverse-shell.php to current working directory.
alias php-reverse-shell="cp /usr/share/webshells/php/php-reverse-shell.php ."

# A slightly better Netcat listener
# Usage: rev 443
alias rev="rlwrap -cAr nc -nvlp"

# Updog is an alternative of python3 -m http.server 80.
alias updog="updog -p 80"

# enum4linux-ng is a newer version of enum4linux. It enumerates Windows SMB.
# Usage: enum4linux-ng -A <ip>
alias enum4linux-ng="python3 /usr/share/enum4linux-ng/enum4linux-ng.py"

# CTF machines usually choose passwords from rockyou.txt, so we use it as default wordlist.
# Usage: john-rockyou hash.txt
alias john-rockyou="john --wordlist=/usr/share/wordlists/rockyou.txt"

# A function that sets target IP address as $IP
# Usage: setip <ip>
setip() {
    echo "export IP=$1" > ~/.zshenv
    source ~/.zshenv
}

# Nmap all scan
# Usage: nmapall <ip>
nmapall() {
    nmapAutomator -H $1 -t all
}
# Nmap vulns scan
# Usage: nmapvulns <ip>
nmapvulns() {
    nmapAutomator -H $1 -t vulns
}

# Gobuster directory fuzzing
# Usage: gobusterit <url>
gobusterit() {
    gobuster dir -u $1 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt | tee gobuster.txt
}

# WPScan with aggressive mode
# Usage: wpscanit <url>
wpscanit() {
    wpscan --url $1 --detection-mode aggressive --api-token <wpscan_token>
}

# xfreerdp with dynamic resolution and set /usr/share/windows-resources as shared drive
# Usage: xfreerdp <ip> <username> <password>
rdp() {
    xfreerdp /v:"$1" /u:"$2" /p:"$3" +clipboard /dynamic-resolution /drive:/usr/share/windows-resources,share
}

# Enumerate domain names
# Usage: get-domain-names <ip>
get-domain-names() {
    crackmapexec smb $1 | tr -s ' ' | cut -d ' ' -f2,4 | sort -t . -k 3,3n -k 4,4n
}

#--------THM--------#

# THM openvpn connection
alias thm="openvpn --config /root/THM/thm.ovpn --pull-filter ignore redirect-gateway"
# Wreath openvpn connection
alias wreath="openvpn --config /root/THM/Wreath/wreath.ovpn --pull-filter ignore redirect-gateway"
# Throwback openvpn connection
alias throwback="openvpn --config /root/THM/Throwback/throwback.ovpn --pull-filter ignore redirect-gateway"
